@* Agent team selector component *@
<div class="mb-3">
    <label class="form-label fw-bold small">AI Agent Team</label>
    
    @if (DisplayMode == "inline")
    {
        <!-- Horizontal checkboxes -->
        <div class="d-flex gap-3 flex-wrap agent-selector-inline">
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" @bind="includeSecurityAgent" 
                       @bind:after="OnSelectionChanged" id="securityAgentInline">
                <label class="form-check-label" for="securityAgentInline">
                    <strong>??? Security</strong>
                </label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" @bind="includePerformanceAgent" 
                       @bind:after="OnSelectionChanged" id="performanceAgentInline">
                <label class="form-check-label" for="performanceAgentInline">
                    <strong>? Performance</strong>
                </label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" @bind="includeArchitectureAgent" 
                       @bind:after="OnSelectionChanged" id="architectureAgentInline">
                <label class="form-check-label" for="architectureAgentInline">
                    <strong>??? Architecture</strong>
                </label>
            </div>
        </div>
    }
    else
    {
        <!-- Original vertical layout -->
        <div class="row">
            <div class="col-12">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" @bind="includeSecurityAgent" 
                           @bind:after="OnSelectionChanged" id="securityAgent">
                    <label class="form-check-label" for="securityAgent">
                        <strong>??? Security Analyst</strong><br>
                        <small class="text-muted">Vulnerability assessment, compliance analysis</small>
                    </label>
                </div>
            </div>
            <div class="col-12 mt-2">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" @bind="includePerformanceAgent" 
                           @bind:after="OnSelectionChanged" id="performanceAgent">
                    <label class="form-check-label" for="performanceAgent">
                        <strong>? Performance Analyst</strong><br>
                        <small class="text-muted">Bottleneck identification, scalability assessment</small>
                    </label>
                </div>
            </div>
            <div class="col-12 mt-2">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" @bind="includeArchitectureAgent" 
                           @bind:after="OnSelectionChanged" id="architectureAgent">
                    <label class="form-check-label" for="architectureAgent">
                        <strong>??? Architecture Analyst</strong><br>
                        <small class="text-muted">Design patterns, SOLID principles, code structure</small>
                    </label>
                </div>
            </div>
        </div>
    }
    
    @if (!GetSelectedAgents().Any())
    {
        <div class="text-danger mt-2">
            <small><i class="bi bi-exclamation-triangle"></i> Please select at least one specialist agent.</small>
        </div>
    }
</div>

@code {
    private bool includeSecurityAgent = true;
    private bool includePerformanceAgent = true;
    private bool includeArchitectureAgent = true;

    [Parameter] public bool IncludeSecurityAgent { get; set; } = true;
    [Parameter] public bool IncludePerformanceAgent { get; set; } = true;
    [Parameter] public bool IncludeArchitectureAgent { get; set; } = true;
    [Parameter] public string DisplayMode { get; set; } = "vertical"; // "vertical" or "inline"
    [Parameter] public EventCallback<List<string>> OnSelectionChange { get; set; }

    private async Task OnSelectionChanged()
    {
        await OnSelectionChange.InvokeAsync(GetSelectedAgents());
    }

    /// <summary>
    /// Gets the list of selected agent names.
    /// </summary>
    public List<string> GetSelectedAgents()
    {
        var agents = new List<string>();
        if (includeSecurityAgent) agents.Add("security");
        if (includePerformanceAgent) agents.Add("performance");
        if (includeArchitectureAgent) agents.Add("architecture");
        return agents;
    }

    /// <summary>
    /// Gets display names for selected agents.
    /// </summary>
    public List<string> GetSelectedAgentDisplayNames()
    {
        var agents = new List<string>();
        if (includeSecurityAgent) agents.Add("Security Analyst");
        if (includePerformanceAgent) agents.Add("Performance Analyst");
        if (includeArchitectureAgent) agents.Add("Architecture Analyst");
        return agents;
    }

    /// <summary>
    /// Auto-configures agent team based on objective.
    /// </summary>
    public void ConfigureForObjective(string objective)
    {
        switch (objective)
        {
            case "security-compliance":
                includeSecurityAgent = true;
                includePerformanceAgent = false;
                includeArchitectureAgent = true;
                break;
            case "performance-optimization":
                includeSecurityAgent = false;
                includePerformanceAgent = true;
                includeArchitectureAgent = true;
                break;
            case "architecture-modernization":
                includeSecurityAgent = true;
                includePerformanceAgent = true;
                includeArchitectureAgent = true;
                break;
            case "comprehensive-audit":
                includeSecurityAgent = true;
                includePerformanceAgent = true;
                includeArchitectureAgent = true;
                break;
        }
        StateHasChanged();
    }
}